(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{759:function(e,t){},786:function(e,t,n){n(8),n(30),n(26),n(10),n(3),n(5),n(29),n(75),n(31),
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(e){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},a=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},i=n.prototype,o=a.prototype,r=e.FileReaderSync,l=function(e){this.code=this[this.name=e]},s="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=s.length,u=e.URL||e.webkitURL||e,p=u.createObjectURL,f=u.revokeObjectURL,d=u,h=e.btoa,b=e.atob,g=e.ArrayBuffer,m=e.Uint8Array;for(a.fake=o.fake=!0;c--;)l.prototype[s[c]]=c+1;return u.createObjectURL||(d=e.URL={}),d.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof a?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):h?t+";base64,"+h(e.data):t+","+encodeURIComponent(e.data)):p?p.call(u,e):void 0},d.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&f&&f.call(u,e)},i.append=function(e){var n=this.data;if(m&&(e instanceof g||e instanceof m)){for(var i="",o=new m(e),s=0,c=o.length;s<c;s++)i+=String.fromCharCode(o[s]);n.push(i)}else if("Blob"===t(e)||"File"===t(e)){if(!r)throw new l("NOT_READABLE_ERR");var u=new r;n.push(u.readAsBinaryString(e))}else e instanceof a?"base64"===e.encoding&&b?n.push(b(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new a(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},o.slice=function(e,t,n){var i=arguments.length;return i<3&&(n=null),new a(this.data.slice(e,i>1?t:this.data.length),n,this.encoding)},o.toString=function(){return"[object Blob]"},o.close=function(){this.size=this.data.length=0},n}(e);e.Blob=function(e,n){var a=n&&n.type||"",i=new t;if(e)for(var o=0,r=e.length;o<r;o++)i.append(e[o]);return i.getBlob(a)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},798:function(e,t){},799:function(e,t){},805:function(e,t,n){"use strict";n.r(t);n(2),n(28),n(13),n(81),n(701),n(3),n(702),n(704),n(705),n(706),n(707),n(708),n(709),n(710),n(711),n(712),n(713),n(714),n(715),n(716),n(717),n(718),n(719),n(720),n(721),n(722),n(723),n(724),n(725),n(726),n(37),n(42),n(154);var a=n(88),i=(n(742),n(26),n(786),n(753)),o=n.n(i);function r(e,t){for(var n,a={},i={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=e.length;++r)for(var l=0;l!=e[r].length;++l){i.s.r>r&&(i.s.r=r),i.s.c>l&&(i.s.c=l),i.e.r<r&&(i.e.r=r),i.e.c<l&&(i.e.c=l);var s={v:e[r][l]};if(null!=s.v){var c=o.a.utils.encode_cell({c:l,r:r});"number"==typeof s.v?s.t="n":"boolean"==typeof s.v?s.t="b":s.v instanceof Date?(s.t="n",s.z=o.a.SSF._table[14],s.v=(n=s.v,void 0&&(n+=1462),(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5)):s.t="s",a[c]=s}}return i.s.c<1e7&&(a["!ref"]=o.a.utils.encode_range(i)),a}function l(){if(!(this instanceof l))return new l;this.SheetNames=[],this.Sheets={}}function s(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}n(783);var c={data:function(){return{list:[],tableList:[],tableColumns:[{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"sex",label:"性别"}],fileListUpload:[],fileTemp:[],loading:!1,multipleSelection:{},page:1,total:0,pageSize:40}},methods:{doDown:function(){window.location.href="https://raw.githubusercontent.com/xrkffgg/Kvue/master/src/assets/excel/demo.xlsx"},onPageChange:function(e){var t=this;setTimeout((function(){t.page=+e,t.tableList=t.list[e-1],t.$nextTick((function(){var n=t.multipleSelection[e]||[];n?n.forEach((function(e){t.$refs.multiple.toggleRowSelection(e)})):t.$refs.multiple.clearSelection()}))}),500)},onSelectionChange:function(e){var t=this;clearTimeout(this.selectionTimer),this.selectionTimer=setTimeout((function(){clearTimeout(t.selectionTimer),t.multipleSelection[t.page]=e}),200)},uploadFile:function(e,t){var n=this;return Object(a.a)(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.raw.type&&"application/vnd.ms-excel"!=e.raw.type){t.next=19;break}return n.loading=!0,t.prev=2,t.next=5,n.importExcel(e.raw);case 5:a=t.sent,a=n.excel2Table(a),n.total=a.length,i=[],n.list=a.reduce((function(e,t,a){return a%n.pageSize==0?((i=[]).push(t),e.push(i)):i.push(t),e}),[]),n.tableList=n.list[0],t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.log(t.t0);case 16:n.loading=!1,t.next=20;break;case 19:n.$message({type:"warning",message:"附件格式错误，请删除后重新上传！"});case 20:case"end":return t.stop()}}),t,null,[[2,13]])})))()},importExcel:function(e){return new Promise((function(t,a){var i=new FileReader;i.onloadend=function(){for(var e="",a=new Uint8Array(this.result),i=a.byteLength,o=0;o<i;o++)e+=String.fromCharCode(a[o]);var r=n(753),l=r.read(e,{type:"binary"});t(r.utils.sheet_to_json(l.Sheets[l.SheetNames[0]]))},i.readAsArrayBuffer(e)}))},excel2Table:function(e){var t=this;return e.map((function(e){return t.tableColumns.reduce((function(t,n){return t[n.prop]=e[n.label]||"",t}),{})}))},exportExcel:function(){var e=this.multipleSelection,t=[];for(var n in e)e[n].length&&(t=t.concat(e[n]));if(!t.length)return this.$message.warning("请选择需要导出的表格");var a=[],i=[];this.tableColumns.map((function(e){a.push(e.label),i.push(e.prop)}));var c=this.formatJson(i,t);if(!c.length)return this.loading=!1;!function(e,t,n){var a=t;a.unshift(e);var i=new l,c=r(a);i.SheetNames.push("SheetJS"),i.Sheets.SheetJS=c;var u=o.a.write(i,{bookType:"xlsx",bookSST:!1,type:"binary"}),p=n||"列表";saveAs(new Blob([s(u)],{type:"application/octet-stream"}),p+".xlsx")}(a,c),this.loading=!1},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))}}},u=n(74),p=Object(u.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-content"},[n("div",{staticStyle:{display:"flex",width:"340px","justify-content":"space-between"}},[n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.doDown}},[e._v("下载 Excel")]),e._v(" "),n("el-upload",{attrs:{action:"","on-change":e.uploadFile,"file-list":e.fileListUpload,"show-file-list":!1,accept:".xls,.xlsx","auto-upload":!1}},[n("el-button",{attrs:{loading:e.loading,size:"small",type:"primary"}},[e._v("上传 Excel")])],1),e._v(" "),n("el-button",{attrs:{type:"success",plain:"",loading:e.loading,size:"small"},on:{click:e.exportExcel}},[e._v("导出 Excel")])],1),e._v(" "),n("el-table",{staticStyle:{"margin-top":"10px",width:"500px"},attrs:{data:e.list,stripe:"",border:""}},e._l(e.tableColumns,(function(e,t){return n("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,align:"center"}})})),1)],1)}),[],!1,null,null,null);t.default=p.exports}}]);